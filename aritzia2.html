<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cookie Preferences</title>
  
  <!-- OneTrust Cookies Consent Notice start for aritzia.com -->
  <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="019037a2-4718-7c29-be9e-b66e351d1ab6-test"></script>
  <script type="text/javascript">
    function OptanonWrapper() {
      if (OneTrust.IsAlertBoxClosed() === false) {
        var banner = document.getElementById("onetrust-banner-sdk");
        var prefpc = document.getElementById("onetrust-pc-sdk");
        var filter = document.getElementsByClassName("onetrust-pc-dark-filter")[0];
        banner.style = "display: none;";
        prefpc.style = "display: block !important; animation: example1 3s linear";
        filter.style = "display: block !important;";
      }
    }
  </script>

  <style>
    @keyframes example1 {
      0% { transform: translateY(-200%); }
      100% { transform: translateY(0%); }
    }

    .iframe-wrapper {
      display: none; /* Initially hidden */
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5); /* Semi-transparent background */
      justify-content: center;
      align-items: center;
      z-index: 1000; /* High z-index to overlay on top of everything */
    }
    .iframe-wrapper iframe {
      width: 80%;
      height: 80%;
      border: none;
    }
  </style>
  
  <!-- OneTrust Cookies Consent Notice end for aritzia.com -->
</head>
<body>
  <button onclick="Optanon.TriggerConsentUI()">Open Cookie Preferences</button>

  <!-- Iframe wrapper to display the form on top of the preference center -->
  <div class="iframe-wrapper" id="iframeWrapper">
    <iframe id="dsar-form-iframe" src="about:blank"></iframe>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // This opens the preference center directly when the page loads
      Optanon.TriggerConsentUI();

      // Monitor the DOM for changes to detect when the preference center is loaded
      var observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (mutation.addedNodes.length) {
            mutation.addedNodes.forEach(function(node) {
              if (node.id === 'onetrust-pc-sdk' || node.classList.contains('onetrust-pc-dark-filter')) {
                // Attach the event listener to intercept the link click inside the preference center
                setupLinkInterception();
              }
            });
          }
        });
      });

      // Start observing the body for added child nodes
      observer.observe(document.body, { childList: true, subtree: true });

      // Function to set up the link interception
      function setupLinkInterception() {
        var link = document.querySelector('#lulu-ot-opt-out-link');
        if (link) {
          link.addEventListener('click', function(event) {
            event.preventDefault(); // Prevent the default link behavior
            showIframe('/dns-form'); // Show the iframe with the form
          });
        }
      }
    });

    // Function to show the iframe on top of the preference center
    function showIframe(url) {
      var iframeWrapper = document.getElementById('iframeWrapper');
      var iframe = document.getElementById('dsar-form-iframe');
      iframe.src = url; // Set the URL of the iframe
      iframeWrapper.style.display = 'flex';
    }

    // Example to close the iframe if needed
    function closeIframe() {
      var iframeWrapper = document.getElementById('iframeWrapper');
      iframeWrapper.style.display = 'none';
      document.getElementById('dsar-form-iframe').src = 'about:blank'; // Clear the iframe content
    }
  </script>
</body>
</html>
